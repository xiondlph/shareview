# Shareview
Сервис отзывов

# Сообщения об ошибках

В случае возникновения ошибки, обработка запроса прекращается,
сервер возвращает HTTP-статус ответа, отражающий суть произошедшей ошибки.
Кроме статуса в ответе передается краткое описание ошибки.

Сообщение об ошибке возвращается в формате JSON

## Внутренняя ошибка сервера
HTTP-статус: `500`

**Выходные данные**
```js
// Описание ошибки (500)
{
    errors: [
        'Internal server error'
    ]
}
```

## Ресурс отсутствует
HTTP-статус: `404`

**Выходные данные**
```js
// Описание ошибки (404)
{
    errors: [
        'Not found'
    ]
}
```

## Отсутсвие доступа к ресурсу
HTTP-статус: `403`

**Выходные данные**
```js
// Описание ошибки (403)
{
    errors: [
        'Forbidden resource'
    ]
}
```

# Методы API
## Регистрация пользователя
POST: `/user/create`

**Входные данные**
```js
{
    email: 'simple@email.com'
}
```

**Выходные данные**
```js
// Успешная регистрация
{
    success: true
}
```

```js
// Пользователь с таким email уже есть
{
    success: false,
    exist: true
}
```

## Авторизация пользователя
POST: `/user/signin`

**Входные данные**
```js
{
    email: 'simple@email.com',
    password: 'password'
}
```

**Выходные данные**
```js
// Успешная регистрация
{
    success: true,
    token: 'jwt-hash', // Трока JSON токена
    profile: {
        // данные профиля (Email, IP и т.д.)
    }
}
```

```js
// Неверные логин/пароль
{
    success: false
}
```

## Выход из сессии
GET: `/user/sigout`

**Входные данные**
```js
// Входные данные отсутствуют
```

**Выходные данные**
```js
// Успешный выход из сессии
{
    success: true
}
```

## Сброс пароля
POST `/user/forgot`

**Входные данные**
```js
{
    email: 'simple@email.com'
}
```

**Выходные данные**
```js
// Успешный сброс пароля
{
    success: true
}
```

```js
// Пользователь не найден
{
    success: false
}
```

### Авторизированная зона

Для работы с методами авторизационной зоны, следует передавать JSON токен, получаный при авторизации.

JSON токен можно передавать как в **GET** или **POST** парамете `token`, так и в пареметре **HTTP** заголовка `x-access-token`.

На текущий момент время действия токена установлено на 24ч.

## Получения данных профиля
GET `/api/profile`

**Входные данные**
```js
// Входные данные отсутствуют
```

**Выходные данные**
```js
// Получения данных профиля
{
    success: true,
    profile: {
        email: 'simple@email.com',
        address: '127.0.0.1', // IP, с которого разрешины выполнения запросов
        key: 'Хеш ключа доступа',
        period: 'date в виде timestamp', // Дата окончания оплаченого периода
    },
}
```

```js
// Отсутсвие доступа к ресурсу (не авторизирован)
{
    errors: [
        'Forbidden resource'
    ]
}
```

## Сохранения данных профиля
PUT `/api/profile`

**Входные данные**
```js
{
    email: 'simple@email.com', // Email для сохранения
    address: '127.0.0.1', // IP для сохранения
}
```

**Выходные данные**
```js
// Успешное сохранения данных профиля
{
    success: true
}
```

```js
// Отсутсвие доступа к ресурсу (не авторизирован)
{
    errors: [
        'Forbidden resource'
    ]
}
```

## Смена текущего пароля
POST `/api/password`

**Входные данные**
```js
{
    password: 'password', // Новый пароль
}
```

**Выходные данные**
```js
// Успешное сохранения данных профиля
{
    success: true
}
```

```js
// Отсутсвие доступа к ресурсу (не авторизирован)
{
    errors: [
        'Forbidden resource'
    ]
}
```
